"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/order/page",{

/***/ "(app-pages-browser)/./app/services/units.ts":
/*!*******************************!*\
  !*** ./app/services/units.ts ***!
  \*******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createUnit: () => (/* binding */ createUnit),\n/* harmony export */   deleteUnit: () => (/* binding */ deleteUnit),\n/* harmony export */   getUnit: () => (/* binding */ getUnit),\n/* harmony export */   getUnits: () => (/* binding */ getUnits),\n/* harmony export */   updateUnit: () => (/* binding */ updateUnit)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(app-pages-browser)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var _qrcode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./qrcode */ \"(app-pages-browser)/./app/services/qrcode.ts\");\n\n\nconst supabaseUrl = \"https://pslapwodbwhedywmlfmk.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBzbGFwd29kYndoZWR5d21sZm1rIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDA1NTQ4NzgsImV4cCI6MjA1NjEzMDg3OH0.YXR7RN1ELBO8ywDv_tXpioTFJrpNXr9UtDLhxzgcHmU\";\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseAnonKey);\nasync function getUnits(buildingId) {\n    try {\n        // Get the current authenticated user\n        const { data: { user }, error: userError } = await supabase.auth.getUser();\n        if (userError) {\n            console.error('Auth error:', userError);\n            throw new Error(\"Failed to get current user: \".concat(userError.message));\n        }\n        if (!user) {\n            console.warn('No authenticated user found');\n            return [];\n        }\n        // First, get the list of buildings owned by this user\n        const { data: userBuildings, error: buildingsError } = await supabase.from('buildings').select('id').eq('user_id', user.id);\n        if (buildingsError) {\n            console.error('Supabase error fetching buildings:', buildingsError);\n            throw new Error(\"Failed to fetch user buildings: \".concat(buildingsError.message));\n        }\n        const userBuildingIds = (userBuildings === null || userBuildings === void 0 ? void 0 : userBuildings.map((b)=>b.id)) || [];\n        if (userBuildingIds.length === 0) {\n            return [];\n        }\n        let query = supabase.from('units').select('*').in('building_id', userBuildingIds).order('unit_number');\n        if (buildingId) {\n            // If a specific building is requested, verify it belongs to the user\n            if (userBuildingIds.includes(buildingId)) {\n                query = query.eq('building_id', buildingId);\n            } else {\n                console.warn(\"Building \".concat(buildingId, \" does not belong to user \").concat(user.id));\n                return [];\n            }\n        }\n        const { data, error } = await query;\n        if (error) {\n            console.error('Supabase error:', error);\n            throw new Error(\"Failed to fetch units: \".concat(error.message));\n        }\n        if (!data) {\n            throw new Error('No data returned from Supabase');\n        }\n        return data;\n    } catch (error) {\n        console.error('Error in getUnits:', error);\n        throw error;\n    }\n}\nasync function getUnit(id) {\n    try {\n        // Get the current authenticated user\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            throw new Error('You must be logged in to view unit details');\n        }\n        // Get the user's buildings\n        const { data: userBuildings } = await supabase.from('buildings').select('id').eq('user_id', user.id);\n        const userBuildingIds = (userBuildings === null || userBuildings === void 0 ? void 0 : userBuildings.map((b)=>b.id)) || [];\n        // Get the unit and verify it belongs to one of the user's buildings\n        const { data, error } = await supabase.from('units').select('*').eq('id', id).single();\n        if (error) {\n            console.error('Supabase error:', error);\n            throw error;\n        }\n        // Check if this unit belongs to one of the user's buildings\n        if (!userBuildingIds.includes(data.building_id)) {\n            throw new Error('You do not have permission to access this unit');\n        }\n        return data;\n    } catch (error) {\n        console.error('Error in getUnit:', error);\n        throw error;\n    }\n}\nasync function createUnit(unit) {\n    try {\n        // Get the current authenticated user\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            throw new Error('You must be logged in to create a unit');\n        }\n        // Check if the building belongs to the user\n        const { data: buildingData, error: buildingError } = await supabase.from('buildings').select('id').eq('id', unit.building_id).eq('user_id', user.id).single();\n        if (buildingError || !buildingData) {\n            throw new Error('You do not have permission to add units to this building');\n        }\n        console.log('[Unit Debug] Creating new unit:', unit);\n        // First create the unit without QR code\n        const { data, error } = await supabase.from('units').insert([\n            unit\n        ]).select().single();\n        if (error) {\n            console.error('[Unit Debug] Supabase error creating unit:', error);\n            throw error;\n        }\n        console.log('[Unit Debug] Unit created successfully:', data);\n        // Now generate and assign QR code\n        try {\n            console.log('[Unit Debug] Starting QR code generation for unit:', data.id);\n            const qrCodeUrl = await (0,_qrcode__WEBPACK_IMPORTED_MODULE_0__.generateAndUploadQRCode)(data.id, data.unit_number, data.building_id);\n            console.log('[Unit Debug] QR code generated, URL:', qrCodeUrl);\n            // Update the unit with the QR code URL\n            console.log('[Unit Debug] Updating unit with QR code URL');\n            const { data: updatedData, error: updateError } = await supabase.from('units').update({\n                qr_code_url: qrCodeUrl\n            }).eq('id', data.id).select().single();\n            if (updateError) {\n                console.error('[Unit Debug] Error updating unit with QR code:', updateError);\n                // Still return the unit even if QR code assignment fails\n                return data;\n            }\n            console.log('[Unit Debug] Unit updated with QR code URL successfully:', updatedData);\n            return updatedData;\n        } catch (qrError) {\n            console.error('[Unit Debug] Error generating QR code:', qrError);\n            // Return the unit without QR code if generation fails\n            return data;\n        }\n    } catch (error) {\n        console.error('[Unit Debug] Error in createUnit:', error);\n        throw error;\n    }\n}\nasync function updateUnit(unit) {\n    try {\n        // Get the current authenticated user\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            throw new Error('You must be logged in to update a unit');\n        }\n        // Get the unit's building_id first\n        const { data: existingUnit } = await supabase.from('units').select('building_id').eq('id', unit.id).single();\n        if (existingUnit) {\n            // Check if the building belongs to the user\n            const { data: buildingCheck } = await supabase.from('buildings').select('id').eq('id', existingUnit.building_id).eq('user_id', user.id).single();\n            if (!buildingCheck) {\n                throw new Error('You do not have permission to update this unit');\n            }\n        }\n        const { data, error } = await supabase.from('units').update(unit).eq('id', unit.id).select().single();\n        if (error) {\n            console.error('Supabase error:', error);\n            throw error;\n        }\n        return data;\n    } catch (error) {\n        console.error('Error in updateUnit:', error);\n        throw error;\n    }\n}\nasync function deleteUnit(id) {\n    try {\n        // Get the current authenticated user\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            throw new Error('You must be logged in to delete a unit');\n        }\n        // Get the unit's building_id first\n        const { data: existingUnit } = await supabase.from('units').select('building_id').eq('id', id).single();\n        if (existingUnit) {\n            // Check if the building belongs to the user\n            const { data: buildingCheck } = await supabase.from('buildings').select('id').eq('id', existingUnit.building_id).eq('user_id', user.id).single();\n            if (!buildingCheck) {\n                throw new Error('You do not have permission to delete this unit');\n            }\n        }\n        const { error } = await supabase.from('units').delete().eq('id', id);\n        if (error) {\n            console.error('Supabase error:', error);\n            throw error;\n        }\n    } catch (error) {\n        console.error('Error in deleteUnit:', error);\n        throw error;\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2FwcC9zZXJ2aWNlcy91bml0cy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXFEO0FBRUY7QUFFbkQsTUFBTUUsY0FBY0MsMENBQW9DO0FBQ3hELE1BQU1HLGtCQUFrQkgsa05BQXlDO0FBQ2pFLE1BQU1LLFdBQVdSLG1FQUFZQSxDQUFDRSxhQUFhSTtBQUVwQyxlQUFlRyxTQUFTQyxVQUFtQjtJQUNoRCxJQUFJO1FBQ0YscUNBQXFDO1FBQ3JDLE1BQU0sRUFBRUMsTUFBTSxFQUFFQyxJQUFJLEVBQUUsRUFBRUMsT0FBT0MsU0FBUyxFQUFFLEdBQUcsTUFBTU4sU0FBU08sSUFBSSxDQUFDQyxPQUFPO1FBRXhFLElBQUlGLFdBQVc7WUFDYkcsUUFBUUosS0FBSyxDQUFDLGVBQWVDO1lBQzdCLE1BQU0sSUFBSUksTUFBTSwrQkFBaUQsT0FBbEJKLFVBQVVLLE9BQU87UUFDbEU7UUFFQSxJQUFJLENBQUNQLE1BQU07WUFDVEssUUFBUUcsSUFBSSxDQUFDO1lBQ2IsT0FBTyxFQUFFO1FBQ1g7UUFFQSxzREFBc0Q7UUFDdEQsTUFBTSxFQUFFVCxNQUFNVSxhQUFhLEVBQUVSLE9BQU9TLGNBQWMsRUFBRSxHQUFHLE1BQU1kLFNBQzFEZSxJQUFJLENBQUMsYUFDTEMsTUFBTSxDQUFDLE1BQ1BDLEVBQUUsQ0FBQyxXQUFXYixLQUFLYyxFQUFFO1FBRXhCLElBQUlKLGdCQUFnQjtZQUNsQkwsUUFBUUosS0FBSyxDQUFDLHNDQUFzQ1M7WUFDcEQsTUFBTSxJQUFJSixNQUFNLG1DQUEwRCxPQUF2QkksZUFBZUgsT0FBTztRQUMzRTtRQUVBLE1BQU1RLGtCQUFrQk4sQ0FBQUEsMEJBQUFBLG9DQUFBQSxjQUFlTyxHQUFHLENBQUNDLENBQUFBLElBQUtBLEVBQUVILEVBQUUsTUFBSyxFQUFFO1FBRTNELElBQUlDLGdCQUFnQkcsTUFBTSxLQUFLLEdBQUc7WUFDaEMsT0FBTyxFQUFFO1FBQ1g7UUFFQSxJQUFJQyxRQUFRdkIsU0FDVGUs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QUFFLEdBQUcsTUFBTUosU0FBU08sSUFBSSxDQUFDQyxPQUFPO1FBRXRELElBQUksQ0FBQ0osTUFBTTtZQUNULE1BQU0sSUFBSU0sTUFBTTtRQUNsQjtRQUVBLG1DQUFtQztRQUNuQyxNQUFNLEVBQUVQLE1BQU15QyxZQUFZLEVBQUUsR0FBRyxNQUFNNUMsU0FDbENlLElBQUksQ0FBQyxTQUNMQyxNQUFNLENBQUMsZUFDUEMsRUFBRSxDQUFDLE1BQU1DLElBQ1RVLE1BQU07UUFFVCxJQUFJZ0IsY0FBYztZQUNoQiw0Q0FBNEM7WUFDNUMsTUFBTSxFQUFFekMsTUFBTTBDLGFBQWEsRUFBRSxHQUFHLE1BQU03QyxTQUNuQ2UsSUFBSSxDQUFDLGFBQ0xDLE1BQU0sQ0FBQyxNQUNQQyxFQUFFLENBQUMsTUFBTTJCLGFBQWFmLFdBQVcsRUFDakNaLEVBQUUsQ0FBQyxXQUFXYixLQUFLYyxFQUFFLEVBQ3JCVSxNQUFNO1lBRVQsSUFBSSxDQUFDaUIsZUFBZTtnQkFDbEIsTUFBTSxJQUFJbkMsTUFBTTtZQUNsQjtRQUNGO1FBRUEsTUFBTSxFQUFFTCxLQUFLLEVBQUUsR0FBRyxNQUFNTCxTQUNyQmUsSUFBSSxDQUFDLFNBQ0xnQyxNQUFNLEdBQ045QixFQUFFLENBQUMsTUFBTUM7UUFFWixJQUFJYixPQUFPO1lBQ1RJLFFBQVFKLEtBQUssQ0FBQyxtQkFBbUJBO1lBQ2pDLE1BQU1BO1FBQ1I7SUFDRixFQUFFLE9BQU9BLE9BQU87UUFDZEksUUFBUUosS0FBSyxDQUFDLHdCQUF3QkE7UUFDdEMsTUFBTUE7SUFDUjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvam9lbGt3b2gvRG9jdW1lbnRzL0dpdEh1Yi9teXFyY29kZS1odWIvYXBwL3NlcnZpY2VzL3VuaXRzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5pbXBvcnQgeyBVbml0LCBDcmVhdGVVbml0SW5wdXQsIFVwZGF0ZVVuaXRJbnB1dCB9IGZyb20gJy4uL3R5cGVzL3VuaXRzJztcbmltcG9ydCB7IGdlbmVyYXRlQW5kVXBsb2FkUVJDb2RlIH0gZnJvbSAnLi9xcmNvZGUnO1xuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCE7XG5jb25zdCBzdXBhYmFzZUFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSE7XG5jb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VBbm9uS2V5KTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVuaXRzKGJ1aWxkaW5nSWQ/OiBzdHJpbmcpOiBQcm9taXNlPFVuaXRbXT4ge1xuICB0cnkge1xuICAgIC8vIEdldCB0aGUgY3VycmVudCBhdXRoZW50aWNhdGVkIHVzZXJcbiAgICBjb25zdCB7IGRhdGE6IHsgdXNlciB9LCBlcnJvcjogdXNlckVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcbiAgICBcbiAgICBpZiAodXNlckVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdBdXRoIGVycm9yOicsIHVzZXJFcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZXQgY3VycmVudCB1c2VyOiAke3VzZXJFcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIGNvbnNvbGUud2FybignTm8gYXV0aGVudGljYXRlZCB1c2VyIGZvdW5kJyk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIFxuICAgIC8vIEZpcnN0LCBnZXQgdGhlIGxpc3Qgb2YgYnVpbGRpbmdzIG93bmVkIGJ5IHRoaXMgdXNlclxuICAgIGNvbnN0IHsgZGF0YTogdXNlckJ1aWxkaW5ncywgZXJyb3I6IGJ1aWxkaW5nc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2J1aWxkaW5ncycpXG4gICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKTtcbiAgICAgIFxuICAgIGlmIChidWlsZGluZ3NFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgZXJyb3IgZmV0Y2hpbmcgYnVpbGRpbmdzOicsIGJ1aWxkaW5nc0Vycm9yKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIHVzZXIgYnVpbGRpbmdzOiAke2J1aWxkaW5nc0Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHVzZXJCdWlsZGluZ0lkcyA9IHVzZXJCdWlsZGluZ3M/Lm1hcChiID0+IGIuaWQpIHx8IFtdO1xuICAgIFxuICAgIGlmICh1c2VyQnVpbGRpbmdJZHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1bml0cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5pbignYnVpbGRpbmdfaWQnLCB1c2VyQnVpbGRpbmdJZHMpXG4gICAgICAub3JkZXIoJ3VuaXRfbnVtYmVyJyk7XG4gICAgXG4gICAgaWYgKGJ1aWxkaW5nSWQpIHtcbiAgICAgIC8vIElmIGEgc3BlY2lmaWMgYnVpbGRpbmcgaXMgcmVxdWVzdGVkLCB2ZXJpZnkgaXQgYmVsb25ncyB0byB0aGUgdXNlclxuICAgICAgaWYgKHVzZXJCdWlsZGluZ0lkcy5pbmNsdWRlcyhidWlsZGluZ0lkKSkge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdidWlsZGluZ19pZCcsIGJ1aWxkaW5nSWQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBCdWlsZGluZyAke2J1aWxkaW5nSWR9IGRvZXMgbm90IGJlbG9uZyB0byB1c2VyICR7dXNlci5pZH1gKTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2UgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZmV0Y2ggdW5pdHM6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICBpZiAoIWRhdGEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gZGF0YSByZXR1cm5lZCBmcm9tIFN1cGFiYXNlJyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0VW5pdHM6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVbml0KGlkOiBzdHJpbmcpOiBQcm9taXNlPFVuaXQ+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgYXV0aGVudGljYXRlZCB1c2VyXG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XG4gICAgXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IGJlIGxvZ2dlZCBpbiB0byB2aWV3IHVuaXQgZGV0YWlscycpO1xuICAgIH1cbiAgICBcbiAgICAvLyBHZXQgdGhlIHVzZXIncyBidWlsZGluZ3NcbiAgICBjb25zdCB7IGRhdGE6IHVzZXJCdWlsZGluZ3MgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnYnVpbGRpbmdzJylcbiAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpO1xuICAgICAgXG4gICAgY29uc3QgdXNlckJ1aWxkaW5nSWRzID0gdXNlckJ1aWxkaW5ncz8ubWFwKGIgPT4gYi5pZCkgfHwgW107XG4gICAgXG4gICAgLy8gR2V0IHRoZSB1bml0IGFuZCB2ZXJpZnkgaXQgYmVsb25ncyB0byBvbmUgb2YgdGhlIHVzZXIncyBidWlsZGluZ3NcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3VuaXRzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCdpZCcsIGlkKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdTdXBhYmFzZSBlcnJvcjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgdGhpcyB1bml0IGJlbG9uZ3MgdG8gb25lIG9mIHRoZSB1c2VyJ3MgYnVpbGRpbmdzXG4gICAgaWYgKCF1c2VyQnVpbGRpbmdJZHMuaW5jbHVkZXMoZGF0YS5idWlsZGluZ19pZCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gYWNjZXNzIHRoaXMgdW5pdCcpO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldFVuaXQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVVbml0KHVuaXQ6IENyZWF0ZVVuaXRJbnB1dCk6IFByb21pc2U8VW5pdD4ge1xuICB0cnkge1xuICAgIC8vIEdldCB0aGUgY3VycmVudCBhdXRoZW50aWNhdGVkIHVzZXJcbiAgICBjb25zdCB7IGRhdGE6IHsgdXNlciB9IH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcbiAgICBcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgYmUgbG9nZ2VkIGluIHRvIGNyZWF0ZSBhIHVuaXQnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgdGhlIGJ1aWxkaW5nIGJlbG9uZ3MgdG8gdGhlIHVzZXJcbiAgICBjb25zdCB7IGRhdGE6IGJ1aWxkaW5nRGF0YSwgZXJyb3I6IGJ1aWxkaW5nRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnYnVpbGRpbmdzJylcbiAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgIC5lcSgnaWQnLCB1bml0LmJ1aWxkaW5nX2lkKVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgIC5zaW5nbGUoKTtcbiAgICAgIFxuICAgIGlmIChidWlsZGluZ0Vycm9yIHx8ICFidWlsZGluZ0RhdGEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gYWRkIHVuaXRzIHRvIHRoaXMgYnVpbGRpbmcnKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ1tVbml0IERlYnVnXSBDcmVhdGluZyBuZXcgdW5pdDonLCB1bml0KTtcbiAgICAvLyBGaXJzdCBjcmVhdGUgdGhlIHVuaXQgd2l0aG91dCBRUiBjb2RlXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1bml0cycpXG4gICAgICAuaW5zZXJ0KFt1bml0XSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbVW5pdCBEZWJ1Z10gU3VwYWJhc2UgZXJyb3IgY3JlYXRpbmcgdW5pdDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnW1VuaXQgRGVidWddIFVuaXQgY3JlYXRlZCBzdWNjZXNzZnVsbHk6JywgZGF0YSk7XG5cbiAgICAvLyBOb3cgZ2VuZXJhdGUgYW5kIGFzc2lnbiBRUiBjb2RlXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdbVW5pdCBEZWJ1Z10gU3RhcnRpbmcgUVIgY29kZSBnZW5lcmF0aW9uIGZvciB1bml0OicsIGRhdGEuaWQpO1xuICAgICAgY29uc3QgcXJDb2RlVXJsID0gYXdhaXQgZ2VuZXJhdGVBbmRVcGxvYWRRUkNvZGUoXG4gICAgICAgIGRhdGEuaWQsXG4gICAgICAgIGRhdGEudW5pdF9udW1iZXIsXG4gICAgICAgIGRhdGEuYnVpbGRpbmdfaWRcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCdbVW5pdCBEZWJ1Z10gUVIgY29kZSBnZW5lcmF0ZWQsIFVSTDonLCBxckNvZGVVcmwpO1xuICAgICAgXG4gICAgICAvLyBVcGRhdGUgdGhlIHVuaXQgd2l0aCB0aGUgUVIgY29kZSBVUkxcbiAgICAgIGNvbnNvbGUubG9nKCdbVW5pdCBEZWJ1Z10gVXBkYXRpbmcgdW5pdCB3aXRoIFFSIGNvZGUgVVJMJyk7XG4gICAgICBjb25zdCB7IGRhdGE6IHVwZGF0ZWREYXRhLCBlcnJvcjogdXBkYXRlRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCd1bml0cycpXG4gICAgICAgIC51cGRhdGUoeyBxcl9jb2RlX3VybDogcXJDb2RlVXJsIH0pXG4gICAgICAgIC5lcSgnaWQnLCBkYXRhLmlkKVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpO1xuICAgICAgXG4gICAgICBpZiAodXBkYXRlRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignW1VuaXQgRGVidWddIEVycm9yIHVwZGF0aW5nIHVuaXQgd2l0aCBRUiBjb2RlOicsIHVwZGF0ZUVycm9yKTtcbiAgICAgICAgLy8gU3RpbGwgcmV0dXJuIHRoZSB1bml0IGV2ZW4gaWYgUVIgY29kZSBhc3NpZ25tZW50IGZhaWxzXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnW1VuaXQgRGVidWddIFVuaXQgdXBkYXRlZCB3aXRoIFFSIGNvZGUgVVJMIHN1Y2Nlc3NmdWxseTonLCB1cGRhdGVkRGF0YSk7XG4gICAgICByZXR1cm4gdXBkYXRlZERhdGE7XG4gICAgfSBjYXRjaCAocXJFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1VuaXQgRGVidWddIEVycm9yIGdlbmVyYXRpbmcgUVIgY29kZTonLCBxckVycm9yKTtcbiAgICAgIC8vIFJldHVybiB0aGUgdW5pdCB3aXRob3V0IFFSIGNvZGUgaWYgZ2VuZXJhdGlvbiBmYWlsc1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tVbml0IERlYnVnXSBFcnJvciBpbiBjcmVhdGVVbml0OicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVW5pdCh1bml0OiBVcGRhdGVVbml0SW5wdXQpOiBQcm9taXNlPFVuaXQ+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgYXV0aGVudGljYXRlZCB1c2VyXG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XG4gICAgXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IGJlIGxvZ2dlZCBpbiB0byB1cGRhdGUgYSB1bml0Jyk7XG4gICAgfVxuICAgIFxuICAgIC8vIEdldCB0aGUgdW5pdCdzIGJ1aWxkaW5nX2lkIGZpcnN0XG4gICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ1VuaXQgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgndW5pdHMnKVxuICAgICAgLnNlbGVjdCgnYnVpbGRpbmdfaWQnKVxuICAgICAgLmVxKCdpZCcsIHVuaXQuaWQpXG4gICAgICAuc2luZ2xlKCk7XG4gICAgICBcbiAgICBpZiAoZXhpc3RpbmdVbml0KSB7XG4gICAgICAvLyBDaGVjayBpZiB0aGUgYnVpbGRpbmcgYmVsb25ncyB0byB0aGUgdXNlclxuICAgICAgY29uc3QgeyBkYXRhOiBidWlsZGluZ0NoZWNrIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnYnVpbGRpbmdzJylcbiAgICAgICAgLnNlbGVjdCgnaWQnKVxuICAgICAgICAuZXEoJ2lkJywgZXhpc3RpbmdVbml0LmJ1aWxkaW5nX2lkKVxuICAgICAgICAuZXEoJ3VzZXJfaWQnLCB1c2VyLmlkKVxuICAgICAgICAuc2luZ2xlKCk7XG4gICAgICAgIFxuICAgICAgaWYgKCFidWlsZGluZ0NoZWNrKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IGRvIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gdXBkYXRlIHRoaXMgdW5pdCcpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3VuaXRzJylcbiAgICAgIC51cGRhdGUodW5pdClcbiAgICAgIC5lcSgnaWQnLCB1bml0LmlkKVxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuc2luZ2xlKCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHVwZGF0ZVVuaXQ6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVVbml0KGlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgYXV0aGVudGljYXRlZCB1c2VyXG4gICAgY29uc3QgeyBkYXRhOiB7IHVzZXIgfSB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XG4gICAgXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IGJlIGxvZ2dlZCBpbiB0byBkZWxldGUgYSB1bml0Jyk7XG4gICAgfVxuICAgIFxuICAgIC8vIEdldCB0aGUgdW5pdCdzIGJ1aWxkaW5nX2lkIGZpcnN0XG4gICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ1VuaXQgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgndW5pdHMnKVxuICAgICAgLnNlbGVjdCgnYnVpbGRpbmdfaWQnKVxuICAgICAgLmVxKCdpZCcsIGlkKVxuICAgICAgLnNpbmdsZSgpO1xuICAgICAgXG4gICAgaWYgKGV4aXN0aW5nVW5pdCkge1xuICAgICAgLy8gQ2hlY2sgaWYgdGhlIGJ1aWxkaW5nIGJlbG9uZ3MgdG8gdGhlIHVzZXJcbiAgICAgIGNvbnN0IHsgZGF0YTogYnVpbGRpbmdDaGVjayB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2J1aWxkaW5ncycpXG4gICAgICAgIC5zZWxlY3QoJ2lkJylcbiAgICAgICAgLmVxKCdpZCcsIGV4aXN0aW5nVW5pdC5idWlsZGluZ19pZClcbiAgICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgICAgLnNpbmdsZSgpO1xuICAgICAgICBcbiAgICAgIGlmICghYnVpbGRpbmdDaGVjaykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGRlbGV0ZSB0aGlzIHVuaXQnKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd1bml0cycpXG4gICAgICAuZGVsZXRlKClcbiAgICAgIC5lcSgnaWQnLCBpZCk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1cGFiYXNlIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBkZWxldGVVbml0OicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufSAiXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50IiwiZ2VuZXJhdGVBbmRVcGxvYWRRUkNvZGUiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUFub25LZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlIiwiZ2V0VW5pdHMiLCJidWlsZGluZ0lkIiwiZGF0YSIsInVzZXIiLCJlcnJvciIsInVzZXJFcnJvciIsImF1dGgiLCJnZXRVc2VyIiwiY29uc29sZSIsIkVycm9yIiwibWVzc2FnZSIsIndhcm4iLCJ1c2VyQnVpbGRpbmdzIiwiYnVpbGRpbmdzRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInVzZXJCdWlsZGluZ0lkcyIsIm1hcCIsImIiLCJsZW5ndGgiLCJxdWVyeSIsImluIiwib3JkZXIiLCJpbmNsdWRlcyIsImdldFVuaXQiLCJzaW5nbGUiLCJidWlsZGluZ19pZCIsImNyZWF0ZVVuaXQiLCJ1bml0IiwiYnVpbGRpbmdEYXRhIiwiYnVpbGRpbmdFcnJvciIsImxvZyIsImluc2VydCIsInFyQ29kZVVybCIsInVuaXRfbnVtYmVyIiwidXBkYXRlZERhdGEiLCJ1cGRhdGVFcnJvciIsInVwZGF0ZSIsInFyX2NvZGVfdXJsIiwicXJFcnJvciIsInVwZGF0ZVVuaXQiLCJleGlzdGluZ1VuaXQiLCJidWlsZGluZ0NoZWNrIiwiZGVsZXRlVW5pdCIsImRlbGV0ZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./app/services/units.ts\n"));

/***/ })

});